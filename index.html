<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>CI Testing for shiny • shinycoreci</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="CI Testing for shiny">
<meta name="description" content="Core shiny team tools to facilitate testing of the shiny-verse.">
<meta property="og:description" content="Core shiny team tools to facilitate testing of the shiny-verse.">
<!-- See https://stackoverflow.com/questions/1865837/whats-the-difference-between-window-location-and-window-location-replace — we use .replace() because we don't want the old url to appear in the browser history. --><script>
  if (!/(\/|html?)$/.test(window.location.href)){
    window.location.replace(window.location.href + '/');
  }
</script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">shinycoreci</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9009</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/shinycoreci/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="shinycoreci">shinycoreci<a class="anchor" aria-label="anchor" href="#shinycoreci"></a>
</h1></div>
<!-- badges: start -->

<!-- This is an R package to install all dependencies to test the bleeding edge of all relevant packages to the Shiny team. -->
<!-- For more direct usage examples, see [`rstudio/shinycoreci-apps`](https://github.com/rstudio/shinycoreci-apps). -->
<div class="section level2">
<h2 id="github-runner-images">Github Runner Images<a class="anchor" aria-label="anchor" href="#github-runner-images"></a>
</h2>
<p>shinycoreci <a href="https://github.com/rstudio/shinycoreci/blob/main/.github/workflows/apps-config.yml" class="external-link">uses the following GitHub Runnner Images</a>.</p>
<table class="table">
<colgroup>
<col width="6%">
<col width="30%">
<col width="63%">
</colgroup>
<thead><tr class="header">
<th align="left">Image</th>
<th align="left">Details</th>
<th align="center">Status</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Ubuntu 20.04</td>
<td align="left"><a href="https://github.com/actions/runner-images/blob/main/images/ubuntu/Ubuntu2004-Readme.md" class="external-link">ubuntu-20.04</a></td>
<td align="center"><a href="https://gh-runnerimagesdeploymentstatus.azurewebsites.net/api/status?imageName=ubuntu20&amp;redirect=1" class="external-link"><img src="https://gh-runnerimagesdeploymentstatus.azurewebsites.net/api/status?imageName=ubuntu20&amp;badge=1" alt="status20"></a></td>
</tr>
<tr class="even">
<td align="left">macOS 12</td>
<td align="left"><a href="https://github.com/actions/runner-images/blob/main/images/macos/macos-12-Readme.md" class="external-link">macos-12</a></td>
<td align="center"><a href="https://gh-runnerimagesdeploymentstatus.azurewebsites.net/api/status?imageName=macos-12&amp;redirect=1" class="external-link"><img src="https://gh-runnerimagesdeploymentstatus.azurewebsites.net/api/status?imageName=macos-12&amp;badge=1" alt="statusumac12"></a></td>
</tr>
<tr class="odd">
<td align="left">Windows Server 2022</td>
<td align="left"><a href="https://github.com/actions/runner-images/blob/main/images/windows/Windows2022-Readme.md" class="external-link">windows-2022</a></td>
<td align="center"><a href="https://gh-runnerimagesdeploymentstatus.azurewebsites.net/api/status?imageName=windows-2022&amp;redirect=1" class="external-link"><img src="https://gh-runnerimagesdeploymentstatus.azurewebsites.net/api/status?imageName=windows-2022&amp;badge=1" alt="statuswin22"></a></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"rstudio/shinycoreci"</span><span class="op">)</span></span></code></pre></div>
<p>These GitHub packages will be installed to make sure the latest package development is working as expected:</p>
<ul>
<li><a href="https://github.com/rstudio/bsicons" class="external-link">rstudio/bsicons</a></li>
<li><a href="https://github.com/rstudio/bslib" class="external-link">rstudio/bslib</a></li>
<li><a href="https://github.com/r-lib/cachem" class="external-link">r-lib/cachem</a></li>
<li><a href="https://github.com/rstudio/chromote" class="external-link">rstudio/chromote</a></li>
<li><a href="https://github.com/rstudio/crosstalk" class="external-link">rstudio/crosstalk</a></li>
<li><a href="https://github.com/rstudio/DT" class="external-link">rstudio/DT</a></li>
<li><a href="https://github.com/rstudio/dygraphs" class="external-link">rstudio/dygraphs</a></li>
<li><a href="https://github.com/r-lib/fastmap" class="external-link">r-lib/fastmap</a></li>
<li><a href="https://github.com/rstudio/flexdashboard" class="external-link">rstudio/flexdashboard</a></li>
<li><a href="https://github.com/rstudio/fontawesome" class="external-link">rstudio/fontawesome</a></li>
<li><a href="https://github.com/rstudio/gt" class="external-link">rstudio/gt</a></li>
<li><a href="https://github.com/rstudio/htmltools" class="external-link">rstudio/htmltools</a></li>
<li><a href="https://github.com/ramnathv/htmlwidgets" class="external-link">ramnathv/htmlwidgets</a></li>
<li><a href="https://github.com/rstudio/httpuv" class="external-link">rstudio/httpuv</a></li>
<li><a href="https://github.com/r-lib/later" class="external-link">r-lib/later</a></li>
<li><a href="https://github.com/rstudio/leaflet" class="external-link">rstudio/leaflet</a></li>
<li><a href="https://github.com/ropensci/plotly" class="external-link">ropensci/plotly</a></li>
<li><a href="https://github.com/rstudio/pool" class="external-link">rstudio/pool</a></li>
<li><a href="https://github.com/rstudio/promises" class="external-link">rstudio/promises</a></li>
<li><a href="https://github.com/rstudio/reactlog" class="external-link">rstudio/reactlog</a></li>
<li><a href="https://github.com/rstudio/sass" class="external-link">rstudio/sass</a></li>
<li><a href="https://github.com/rstudio/shiny" class="external-link">rstudio/shiny</a></li>
<li><a href="https://github.com/rstudio/shinycoreci" class="external-link">rstudio/shinycoreci</a></li>
<li><a href="https://github.com/schloerke/shinyjster" class="external-link">schloerke/shinyjster</a></li>
<li><a href="https://github.com/rstudio/shinymeta" class="external-link">rstudio/shinymeta</a></li>
<li><a href="https://github.com/rstudio/shinytest" class="external-link">rstudio/shinytest</a></li>
<li><a href="https://github.com/rstudio/shinytest2" class="external-link">rstudio/shinytest2</a></li>
<li><a href="https://github.com/rstudio/shinythemes" class="external-link">rstudio/shinythemes</a></li>
<li><a href="https://github.com/rstudio/shinyvalidate" class="external-link">rstudio/shinyvalidate</a></li>
<li><a href="https://github.com/rstudio/thematic" class="external-link">rstudio/thematic</a></li>
<li><a href="https://github.com/rstudio/webdriver" class="external-link">rstudio/webdriver</a></li>
<li><a href="https://github.com/rstudio/websocket" class="external-link">rstudio/websocket</a></li>
</ul>
<div class="section level4">
<h4 id="r-universe">R-Universe<a class="anchor" aria-label="anchor" href="#r-universe"></a>
</h4>
<p><a href="https://github.com/rstudio/shinycoreci" class="external-link">shinycoreci</a> testing leverages rOpenSci <a href="https://r-universe.dev/search/" class="external-link"><code>r-universe</code></a>, specifically the <a href="https://posit-dev-shinycoreci.r-universe.dev/builds" class="external-link"><code>posit-dev-shinycoreci</code></a> universe. This universe is used to install the latest development versions of the Shiny related packages (updated hourly) used in the testing apps without the need for a GitHub token. This last detail is important, as it allows GitHub Actions to install packages freely without the worry of being rate limited. This gives us the ability to attempt to install each app’s dependencies independently, leading to higher test coverage as a single dependencies does not block the entire test execution.</p>
</div>
</div>
<div class="section level2">
<h2 id="running-manual-tests">Running manual tests<a class="anchor" aria-label="anchor" href="#running-manual-tests"></a>
</h2>
<p>First, install the <a href="https://github.com/rstudio/shinycoreci" class="external-link">shinycoreci</a> repo via {pak} (from instructions above). Before running any tests, you may need to add your <code>GITHUB_PAT</code> to your R Environ file (See <code>?usethis::edit_r_environ</code> and <code>?usethis::create_github_token</code>)</p>
<p>Commands used to test in different situations:</p>
<ul>
<li>
<a href="https://rstudio.com/products/rstudio/download/#download" class="external-link">RStudio IDE</a> - <code><a href="reference/test_in_ide.html">shinycoreci::test_in_ide()</a></code>
</li>
<li>
<a href="http://rstudio.cloud" class="external-link">RStudio Cloud</a> - <code><a href="reference/test_in_ide.html">shinycoreci::test_in_ide()</a></code>
</li>
<li>
<a href="https://colorado.rstudio.com" class="external-link">RStudio Server Pro</a> - <code><a href="reference/test_in_ide.html">shinycoreci::test_in_ide()</a></code>
</li>
<li>R Terminal / R GUI - <code><a href="reference/test_in_browser.html">shinycoreci::test_in_browser()</a></code>
</li>
<li>(Any) Web Browser - <code><a href="reference/test_in_browser.html">shinycoreci::test_in_browser()</a></code>
</li>
<li>
<a href="http://shinyapps.io" class="external-link">shinyapps.io</a> - <code><a href="reference/test_in_deployed.html">shinycoreci::test_in_shinyappsio()</a></code>
</li>
<li>
<a href="http://dogfood.team.pct.posit.it" class="external-link">Posit Connect</a> - <code><a href="reference/test_in_deployed.html">shinycoreci::test_in_connect()</a></code>
</li>
<li>SSO - <code>shinycoreci::test_in_sso(release = "focal")</code> &gt; Requires <code>Docker</code> application to be running</li>
<li>SSP - <code>shinycoreci::test_in_ssp(release = "centos7")</code> &gt; Requires <code>Docker</code> application to be running</li>
</ul>
<p>All testing functions may be run from within the IDE (except for R Terminal / R GUI).</p>
<div class="section level4">
<h4 id="ide-example">IDE Example<a class="anchor" aria-label="anchor" href="#ide-example"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak", repos = sprintf("https://r-lib.github.io/p/pak/stable/%s/%s/%s", .Platform$pkgType, R.Version()$os, R.Version()$arch))</span></span>
<span></span>
<span><span class="co"># Install the latest from pak</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"rstudio/shinycoreci"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install shinyverse</span></span>
<span><span class="co"># Run all manual tests</span></span>
<span><span class="fu">shinycoreci</span><span class="fu">::</span><span class="fu"><a href="reference/test_in_ide.html">test_in_ide</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="view-the-latest-test-results">View the latest test results<a class="anchor" aria-label="anchor" href="#view-the-latest-test-results"></a>
</h2>
<p>To view the latest test results, please visit <a href="https://rstudio.github.io/shinycoreci/results/" class="uri">https://rstudio.github.io/shinycoreci/results/</a>. This link will update to the latest results when they are pushed.</p>
<p>If you see failures, this indicates that a test has failed. If it is related to a <a href="https://rstudio.github.io/shinytest2/" class="external-link">shinytest2</a> snapshot failure, we can view and approve these failures with <code><a href="reference/fix_snaps.html">shinycoreci::fix_snaps()</a></code>. Your working directory must be in a local checkout of the <code>rstudio/shinycoreci</code> repo. Once <code><a href="reference/fix_snaps.html">shinycoreci::fix_snaps()</a></code> has finished running, use <a href="https://desktop.github.com/" class="external-link">GitHub Desktop</a> to view the changes.</p>
<p>If you receive the error <code>No information found for sha: ABC1234 . Do you have a valid sha?</code>, you may have to provide the git sha value directly: <code>shinycoreci::fix_snaps(sha = "XYZ5678")</code>.</p>
<p>In the event that all testing failures can not be addressed by updating <a href="https://rstudio.github.io/shinytest2/" class="external-link">shinytest2</a> baselines, have a look at the <a href="https://github.com/rstudio/shinycoreci/actions" class="external-link">GHA actions</a> build log and keep the following troubleshooting tips in mind:</p>
<div class="section level3">
<h3 id="troubleshooting-test-failures">Troubleshooting test failures<a class="anchor" aria-label="anchor" href="#troubleshooting-test-failures"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Failures on old versions of R</li>
</ol>
<p>If a testing app passes on recent version(s) of R, but fails in a suprising way on old R version(s), it may be due to an old R package version. In that case, modify the tests to run only if a sufficient version of the relevant package is available (<a href="https://github.com/rstudio/shinycoreci/blob/d8f627bea573cf7bb7a53788522f04d90aeb557f/inst/apps/145-dt-replacedata/tests/testthat/test-mytest.R" class="external-link">for example</a>).</p>
<ol start="2" style="list-style-type: decimal">
<li>Other failures that can’t replicated locally</li>
</ol>
<p>Other surprising failures are often the result of timing issues (which can be difficult, if not impossible, to replicate locally). If your testing app uses dynamic UI and/or doesn’t have proper input/output bindings, <strong>shinytest2</strong> probably needs to know how long to wait for value(s) to update (in this case, use <code>app$wait_for_idle()</code>, <a href="https://github.com/rstudio/shinycoreci/blob/46cdf9df12ee665d5ac77f85eb22f511ce8a4fe6/inst/apps/135-bookmark-uioutput/tests/testthat/test-mytest.R#L6" class="external-link">for example</a>). Somewhat similarly, when checking DOM values with <strong>shinyjster</strong>, you may need to wait for an update to DOM element(s) before checking value(s), in which case you can write a recursive function that keeps calling itself until the DOM is ready (<a href="https://github.com/rstudio/shinycoreci/blob/46cdf9df12ee665d5ac77f85eb22f511ce8a4fe6/inst/apps/187-navbar-collapse/app.R#L27-L36" class="external-link">for example</a>).</p>
<ol start="3" style="list-style-type: decimal">
<li>All of the windows shinytest plots have failed</li>
</ol>
<p>When Windows virtual images update on GitHub Actions, the graphics device may behave exactly as the prior graphics device. Check to see if your windows <code>Image Version</code> has updated. (To view this, inspect the top lines in <code>./inst/apps/sys-info-win-XX.txt</code> for a change.) You should accept the updated shinytest output for the build with the higher <code>Image Version</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="contribute-a-testing-app">Contribute a testing app<a class="anchor" aria-label="anchor" href="#contribute-a-testing-app"></a>
</h2>
<p>When contributing a testing app, try to do the following:</p>
<ul>
<li>Capture all the functionality with automated tests.
<ul>
<li>Also, where possible, write “light-weight” tests (that is, try and avoid <strong>shinytest2</strong> <code>$expect_screenshot()</code> where possible since they are prone to false positive differences and thus have a maintenance cost).</li>
<li>If the app does need manual testing, flag the testing app for manual testing with <code><a href="reference/use_manual_app.html">shinycoreci::use_manual_app()</a></code>.</li>
</ul>
</li>
<li>Add a description to the app’s UI that makes it clear what the app is testing for.</li>
</ul>
<p>Note that <strong>shinycoreci</strong> only supports <a href="https://testthat.r-lib.org" class="external-link">testthat</a> testing framework. Call <code>shinytest2::use_shinytest2(APP_DIR)</code> to use <a href="https://rstudio.github.io/shinytest2/" class="external-link">shinytest2</a> and <a href="https://testthat.r-lib.org" class="external-link">testthat</a></p>
<ol style="list-style-type: decimal">
<li><p><strong>shinytest2</strong>: primarily useful for taking screenshots of shiny output binding(s) (before or after interacting with <strong>shiny</strong> input bindings). <a href="https://github.com/rstudio/shinycoreci/blob/d8f627bea573cf7bb7a53788522f04d90aeb557f/inst/apps/001-hello/tests/testthat/test-mytest.R" class="external-link">See here</a> for an example (note that <code><a href="https://rstudio.github.io/shinytest2/reference/record_test.html" class="external-link">shinytest2::record_test()</a></code> can be used to generate shinytest2 testing scripts).</p></li>
<li><p><strong>shinyjster</strong>: primarily useful for asserting certain expectations about the DOM (in JavaScript). <a href="https://github.com/rstudio/shinycoreci-apps/blob/5691d1f/apps/001-hello/app.R#L37-L61" class="external-link">See here</a> for an example (note that <code>shinyjster::shinyjster_js()</code> needs to be placed in the UI and <code>shinyjster::shinyjster_server(input, output)</code> needs to be placed in the server).</p></li>
<li><p><strong>testthat</strong>: primarily useful in combination with <code><a href="https://rdrr.io/pkg/shiny/man/testServer.html" class="external-link">shiny::testServer()</a></code> to test server-side reactive logic of the application.</p></li>
</ol>
<ul>
<li>
<a href="https://github.com/rstudio/shinycoreci-apps/blob/5691d1f4/apps/001-hello/tests/testthat/tests.R#L4" class="external-link">See here</a> for an example.</li>
</ul>
</div>
<div class="section level2">
<h2 id="pruning-old-git-branches">Pruning old git branches<a class="anchor" aria-label="anchor" href="#pruning-old-git-branches"></a>
</h2>
<p>To help us store and manage the test results, git branches are automatically created for each test run. These branches are automatically removed on GitHub after 1 week of no activity, but you may want to periodically remove them on your local machine as well:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">git</span> fetch <span class="at">--prune</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="what-workflows-are-available">What workflows are available?<a class="anchor" aria-label="anchor" href="#what-workflows-are-available"></a>
</h2>
<p>This repo contains several <a href="https://github.com/features/actions" class="external-link">GitHub Actions</a> workflows:</p>
<ul>
<li>
<a href="https://github.com/rstudio/shinycoreci/actions/workflows/apps-test-matrix.yml" class="external-link"><strong>Test apps:</strong></a> Run all automated tests (via <code><a href="https://rdrr.io/pkg/shiny/man/runTests.html" class="external-link">shiny::runTests()</a></code>). If on <code>main</code> branch, test results will be saved to <code>_test_results</code> branch.</li>
<li>
<a href="https://github.com/rstudio/shinycoreci/actions/workflows/apps-docker.yml" class="external-link"><strong>Docker:</strong></a> Create all SSO and SSP docker images. Docker images are hosted on <a href="https://github.com/rstudio/shinycoreci/pkgs/container/shinycoreci" class="external-link"><code>rstudio/shinycoreci</code> via GitHub Packages</a>.</li>
<li>
<a href="https://github.com/rstudio/shinycoreci/actions/workflows/apps-deploy.yml" class="external-link"><strong>Deploy</strong></a>: Deploy all testing apps to <a href="https://shinyapps.io" class="external-link">shinyapps.io</a> and <a href="https://dogfood.team.pct.posit.it" class="external-link">dogfood.team.pct.posit.it</a>
</li>
<li>
<a href="https://github.com/rstudio/shinycoreci/actions/workflows/build-results.yml" class="external-link"><strong>Build results website</strong></a>: Builds results for <strong>Test apps</strong> workflow. This workflow is called from within <strong>Test apps</strong>. After all tests have completed, this workflow will process all results in <code>_test_results</code> branch into static files, storing the results in <code>gh-pages</code> branch. Final website location of results: <a href="https://rstudio.github.io/shinycoreci/results/" class="uri">https://rstudio.github.io/shinycoreci/results/</a>
</li>
<li>
<a href="https://github.com/rstudio/shinycoreci/actions/workflows/R-CMD-check.yaml" class="external-link"><strong>Package checks</strong></a>: There are three main tasks that this workflow achieves:
<ol style="list-style-type: decimal">
<li>Creates the <code>website</code> via <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
</li>
<li>Performs <code>routine</code> procedures like making sure all documentation and README.md is up to date</li>
<li>Performs <code>R CMD check</code> on <a href="https://github.com/rstudio/shinycoreci" class="external-link">shinycoreci</a>, across macOS, Windows, and Ubuntu (multiple R versions).</li>
</ol>
</li>
<li>
<a href="https://github.com/rstudio/shinycoreci/actions/workflows/apps-deps.yml" class="external-link"><strong>Update app deps</strong></a>: Updates known dependencies of all Shiny applications in <code>./inst/apps</code>.</li>
<li>
<a href="https://github.com/rstudio/shinycoreci/actions/workflows/trim-old-branches.yml" class="external-link"><strong>Trim old branches</strong></a>: The current data model of <strong>Test apps</strong> workflow is to create many <code>gha-**</code> branches containing the changes of each test run on <code>main</code>. <code>gha-**</code> branches that have been stale for more than a week are removed.</li>
</ul>
<div class="section level3">
<h3 id="trigger">Trigger<a class="anchor" aria-label="anchor" href="#trigger"></a>
</h3>
<p>There are a handful of methods that can be called to trigger the GHA actions.</p>
<ul>
<li>
<code><a href="reference/trigger.html">shinycoreci::trigger_tests()</a></code>: Trigger the <strong>Test apps</strong> workflow.</li>
<li>
<code><a href="reference/trigger.html">shinycoreci::trigger_docker()</a></code>: Trigger the <strong>Docker</strong> workflow.</li>
<li>
<code><a href="reference/trigger.html">shinycoreci::trigger_deploy()</a></code>: Trigger the <strong>Deploy</strong> workflow.</li>
<li>
<code><a href="reference/trigger.html">shinycoreci::trigger_results()</a></code>: Trigger the <strong>Build results website</strong> workflow.</li>
<li>
<code>shinycoreci::trigger(event_type=)</code>: Sends a custom event to the GHA workflow. For example, this can be used to trigger <strong>Trim old branches</strong> with <code>shinycoreci::trigger("trim")</code>.</li>
</ul>
<p>A triggered workflow will run without having to push to the repo. Anyone with repo write access can call this command.</p>
</div>
<div class="section level3">
<h3 id="schedule">Schedule<a class="anchor" aria-label="anchor" href="#schedule"></a>
</h3>
<p>Most of the workflows are run on schedule.</p>
<p>Example schedule where the workflow is run at 2am UTC Monday through Friday:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="at">  </span><span class="fu">schedule</span><span class="kw">:</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">cron</span><span class="kw">:</span><span class="at">  </span><span class="st">'0 2 * * 1-5'</span></span></code></pre></div>
<p>Schedule of <code>rstudio/shinycoreci</code> workflows:</p>
<ul>
<li>12am UTC, S-S: <strong>Trim old branches</strong>; &lt; 1 min</li>
<li>12am UTC, M-F: <strong>Update app deps</strong>; &lt; 5 mins</li>
<li>2am UTC, M-F: <strong>Deploy apps</strong>; ~ 2 hrs</li>
<li>3am UTC, M-F: <strong>Docker</strong>; ~ 1 hr</li>
<li>5am UTC, M-F: <strong>Test apps</strong> (Internally calls <strong>Build results website</strong>); ~ 4 hrs</li>
</ul>
</div>
<div class="section level3">
<h3 id="build-resultsyml">
<code>build-results.yml</code><a class="anchor" aria-label="anchor" href="#build-resultsyml"></a>
</h3>
<p>Breakdown of what happens in the <strong>Build results website</strong> workflow:</p>
<p>On completion of <code>apps-test-matrix.yml</code>…</p>
<ul>
<li>GHA will check out the latest <code>_test_results</code> branch into the local folder.</li>
<li>GHA will check out the latest <code>gh-pages</code> branch into the <code>./_gh-pages</code> folder.</li>
<li>GHA will install R and necessary package dependencies.</li>
<li>Run <code>./build_site.R</code>
<ul>
<li>Read the <em>modify times</em> of each file in <code>_test_results</code> and processing files</li>
<li>Compare <em>modify times</em> to <em>modify times</em> of output files</li>
<li>If any input file is newer than the output file, reprocess the documen</li>
<li>If reprocessing, render <code>./render-results.Rmd</code> given proper subset of data
<ul>
<li>Save output to `./_gh-pages/results/YEAR/MONTH/DAY/index.html</li>
</ul>
</li>
<li>Update <code>./_gh-pages/results/index.html</code> to redirect to the most recent results</li>
</ul>
</li>
<li>Within the <code>./_gh-pages</code> directory
<ul>
<li>Add any files that have been altered</li>
<li>Commit and push back any changes to the <code>gh-pages</code> website</li>
</ul>
</li>
</ul>
<p>Final results are available at: <a href="https://rstudio.github.io/shinycoreci/results/" class="uri">https://rstudio.github.io/shinycoreci/results/</a></p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="faq">FAQ:<a class="anchor" aria-label="anchor" href="#faq"></a>
</h1>
<ul>
<li>If you run into an odd <a href="https://pak.r-lib.org/" class="external-link">pak</a> installation issue:
<ul>
<li>Run <code><a href="https://pak.r-lib.org/reference/cache.html" class="external-link">pak::cache_clean()</a></code> to clear the cache and try your original command again</li>
</ul>
</li>
<li>Installing on fresh linux? Run these commands before testing:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'base64enc'</span>, <span class="st">'bslib'</span>, <span class="st">'Cairo'</span>, <span class="st">'clipr'</span>, <span class="st">'curl'</span>, <span class="st">'dbplyr'</span>, <span class="st">'DiagrammeR'</span>,</span>
<span>  <span class="st">'dplyr'</span>, <span class="st">'DT'</span>, <span class="st">'evaluate'</span>, <span class="st">'flexdashboard'</span>, <span class="st">'future'</span>, <span class="st">'ggplot2'</span>,</span>
<span>  <span class="st">'ggvis'</span>, <span class="st">'hexbin'</span>, <span class="st">'htmltools'</span>, <span class="st">'htmlwidgets'</span>,</span>
<span>  <span class="st">'httpuv'</span>, <span class="st">'jsonlite'</span>, <span class="st">'knitr'</span>, <span class="st">'later'</span>, <span class="st">'leaflet'</span>, <span class="st">'magrittr'</span>,</span>
<span>  <span class="st">'maps'</span>, <span class="st">'markdown'</span>, <span class="st">'memoise'</span>, <span class="st">'networkD3'</span>, <span class="st">'plotly'</span>, <span class="st">'png'</span>,</span>
<span>  <span class="st">'progress'</span>, <span class="st">'promises'</span>, <span class="st">'pryr'</span>, <span class="st">'radiant'</span>, <span class="st">'ragg'</span>, <span class="st">'RColorBrewer'</span>,</span>
<span>  <span class="st">'reactable'</span>, <span class="st">'reactlog'</span>, <span class="st">'reactR'</span>, <span class="st">'rlang'</span>, <span class="st">'rmarkdown'</span>, <span class="st">'rprojroot'</span>,</span>
<span>  <span class="st">'rsconnect'</span>, <span class="st">'RSQLite'</span>, <span class="st">'rversions'</span>, <span class="st">'scales'</span>, <span class="st">'sf'</span>, <span class="st">'shiny'</span>,</span>
<span>  <span class="st">'shinyAce'</span>, <span class="st">'shinydashboard'</span>, <span class="st">'shinyjs'</span>, <span class="st">'shinymeta'</span>,</span>
<span>  <span class="st">'shinytest2'</span>, <span class="st">'shinythemes'</span>, <span class="st">'shinyvalidate'</span>, <span class="st">'showtext'</span>, <span class="st">'sysfonts'</span>,</span>
<span>  <span class="st">'systemfonts'</span>, <span class="st">'testthat'</span>, <span class="st">'thematic'</span>, <span class="st">'tidyr'</span>, <span class="st">'tm'</span>, <span class="st">'websocket'</span>,</span>
<span>  <span class="st">'withr'</span>, <span class="st">'wordcloud'</span>,</span>
<span>  <span class="st">'sessioninfo'</span>,</span>
<span>  <span class="st">'debugme'</span>, <span class="st">'highcharter'</span>, <span class="st">'parsedate'</span>, <span class="st">'quantmod'</span>, <span class="st">'rjson'</span>, <span class="st">'rlist'</span>, <span class="st">'showimage'</span>, <span class="st">'TTR'</span>, <span class="st">'XML'</span>, <span class="st">'xts'</span></span>
<span><span class="op">)</span>;</span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/local_system_requirements.html" class="external-link">pkg_system_requirements</a></span><span class="op">(</span><span class="va">pkgs</span>, execute <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">pkgs</span><span class="op">)</span>;</span>
<span><span class="co"># Now you should be able to go about testing</span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/rstudio/shinycoreci/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/rstudio/shinycoreci/issues" class="external-link">Report a bug</a></li>
<li><a href="./results">Nightly Testing</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing shinycoreci</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="http://schloerke.com" class="external-link">Barret Schloerke</a> <br><small class="roles"> Author, maintainer </small>   </li>
<li>
<a href="https://github.com/wch" class="external-link">Winston Chang</a> <br><small class="roles"> Author </small>   </li>
<li>Alan Dipert <br><small class="roles"> Author </small>   </li>
<li>
<a href="https://www.rstudio.com" class="external-link"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" width="72"></a> <br><small class="roles"> Copyright holder, funder </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle Experimental"></a></li>
<li><a href="https://github.com/rstudio/shinycoreci/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/rstudio/shinycoreci/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R CMD check"></a></li>
<li><a href="https://github.com/rstudio/shinycoreci/actions/workflows/apps-test-matrix.yml" class="external-link"><img src="https://github.com/rstudio/shinycoreci/actions/workflows/apps-test-matrix.yml/badge.svg" alt="Test"></a></li>
<li><a href="https://github.com/rstudio/shinycoreci/actions/workflows/apps-deploy.yml" class="external-link"><img src="https://github.com/rstudio/shinycoreci/actions/workflows/apps-deploy.yml/badge.svg" alt="Deploy"></a></li>
<li><a href="https://github.com/rstudio/shinycoreci/actions/workflows/apps-docker.yml" class="external-link"><img src="https://github.com/rstudio/shinycoreci/actions/workflows/apps-docker.yml/badge.svg" alt="Docker"></a></li>
<li><a href="https://github.com/rstudio/shinycoreci/actions/workflows/apps-deps.yml" class="external-link"><img src="https://github.com/rstudio/shinycoreci/actions/workflows/apps-deps.yml/badge.svg" alt="Dependencies"></a></li>
</ul>
</div>

  </aside>
</div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="http://schloerke.com" class="external-link">Barret Schloerke</a>, <a href="https://github.com/wch" class="external-link">Winston Chang</a>, Alan Dipert, <a href="https://www.rstudio.com" class="external-link"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" width="72"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer>
</body>
</html>
